# Wealthsimple-node

Node.js client for Wealthsimple API: https://developers.wealthsimple.com

This is still under development and is a quick implementation for "Hack the 6". There is not functions for every API and they have not all been fully tested.

## Installation

```
npm install --save https://github.com/anthfran/wealthsimple-node
```

### Examples of Usage

See /examples folder for more

#### Load wealthsimple-node into your project
```
const credentials = {
  "client_id": "XXXXXXXXX",
  "client_secret": "XXXXXXXXX",
  "redirect_uri": "https://localhost:3000/auth"
};
const wealthsimple = require('wealthsimple-node').appId(credentials);
```

#### Exchange an auth code for a token object response
Note: This will return the whole tokens object, some which you may need and some which you may not.
The only keys that are important to save are:
* access_token
* refresh_token
* created_at
* expires_in

You can save the entire response if you want. An example below will create a tokens object that can be used by this library.
```javascript
wealthsimple.tokenExchange(authCode)
.then(response => {
  return {
    access_token: response.access_token,
    refresh_token: response.refresh_token,
    created_at: response.created_at,
    expires_in: response.expires_in
  }
})
.then(tokens => {
  // store tokens
})
.catch(error => {
  // do something with error
});
```

#### Call an API example (List Accounts)
```javascript
let params = {};
wealthsimple.listAccounts(tokens, params);
})
.catch(error => {
  // do something with error
});
```

#### Refresh tokens

```javascript
wealthsimple.tokenRefresh(tokens)
.then(response => {
  return {
    access_token: response.access_token,
    refresh_token: response.refresh_token,
    created_at: response.created_at,
    expires_in: response.expires_in
  }
})
.then(tokens => {
  // store tokens
});
```

#### Utilize "Refresh Token if Expired"
Note, this will check your tokens object
```javascript
wealthsimple.refreshTokenIfExpired(tokens)
.then(refreshed => {
  if (tokens.access_token !== refreshed.access_token) {
    // store new tokens
  }
  let params = {}
  return wealthsimple.listAccounts(tokens, params);
})
.catch(error => {
  // do something with error
});
```


<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [tokenExchange][1]
-   [tokenRefresh][4]
-   [refreshTokenIfExpired][7]
-   [createUser][9]
-   [listUsers][12]
-   [getUser][15]
-   [createPerson][18]
-   [listPeople][21]
-   [getPerson][24]
-   [updatePerson][27]
-   [createAccount][30]
-   [listAccounts][33]
-   [getAccount][36]
-   [getAccountTypes][39]
-   [getDailyValues][42]
-   [listPositions][45]
-   [listTransactions][48]
-   [getProjection][51]
-   [listBankAccounts][54]
-   [createDeposit][57]
-   [listDeposits][60]
-   [getDeposit][63]

## tokenExchange

Exchanges an auth code for OAuth2 tokens

### Parameters

-   `host`  
-   `appCredentials`  
-   `code` **[String][68]** Auth string from Wealthsimple redirect

### Examples

```javascript
wealthsimple.tokenExchange(authCode).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve containing OAuth2 Tokens

## tokenRefresh

Refreshes OAuth2 tokens

### Parameters

-   `host`  
-   `appCredentials`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple

### Examples

```javascript
wealthsimple.tokenRefresh(refreshToken).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve containing OAuth2 Tokens

## refreshTokenIfExpired

If the token is not expired, return the tokens object. Otherwise refreshes the tokens

### Parameters

-   `host`  
-   `appCredentials`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple

Returns **[Promise][69]** Promise which will resolve containing OAuth2 Tokens

## createUser

Create a User
[https://developers.wealthsimple.com/#operation/Create%20User][71]

### Parameters

-   `host`  
-   `appCredentials`  
-   `body` **[Object][70]**

### Examples

```javascript
wealthsimple.createUser(body).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with newly created user

## listUsers

List Users
[https://developers.wealthsimple.com/#operation/List%20Users][72]
This API will return a list of Users scoped by the authorization credentials.

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `params` **[Object][70]?** See Wealthsimple website for an example of the request parameters

### Examples

```javascript
wealthsimple.listUsers(token).then(response=>console.log(response));
```

```javascript
let params = { limit: 25, offset: 50, created_before: "2017-06-21"};
wealthsimple.listUsers(token, params).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with newly created user

## getUser

Get User
[https://developers.wealthsimple.com/#operation/Get%20User][73]

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `userId` **[String][68]** Example "user-12398ud"

### Examples

```javascript
wealthsimple.getUser(token, userId).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with user info

## createPerson

Create Person
[https://developers.wealthsimple.com/#operation/Create%20Person][74]

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `body` **[Object][70]** See Wealthsimple website for an example of the request body

### Examples

```javascript
wealthsimple.createPerson(token, body).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with the created Person

## listPeople

List People
[https://developers.wealthsimple.com/#operation/List%20People][75]
This API will return a list of People scoped by the authorization credentials.

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `params` **[Object][70]** See Wealthsimple website for an example of the request parameters

### Examples

```javascript
wealthsimple.createPerson(token, body).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with the list of people

## getPerson

Get Person
[https://developers.wealthsimple.com/#operation/Get%20Person][76]
Get a Person entity if you know the person_id and the current credentials have access to the Person.

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `personId` **[String][68]** Example "person-12398ud"

### Examples

```javascript
wealthsimple.getPerson(token, "person-12398ud").then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with the Person details

## updatePerson

Update Person
[https://developers.wealthsimple.com/#operation/Update%20Person][77]
You can add/remove information to the Person entity as the information becomes available using this API. To remove a previously set attribute, set the value to null. Attributes that are not mentioned in the request payload will leave the attribute unchanged in the Person entity.

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `personId` **[String][68]** Example "person-12398ud"
-   `body` **[Object][70]** See Wealthsimple website for an example of the body

### Examples

```javascript
wealthsimple.updatePerson(token, "person-12398ud", body).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with the updated Person

## createAccount

Create Account
[https://developers.wealthsimple.com/#operation/Create%20Account][78]
You can add/remove information to the Person entity as the information becomes available using this API. To remove a previously set attribute, set the value to null. Attributes that are not mentioned in the request payload will leave the attribute unchanged in the Person entity.

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `personId` **[String][68]** Example "person-12398ud"
-   `body` **[Object][70]** See Wealthsimple website for an example of the body

### Examples

```javascript
wealthsimple.createAccount(token, body).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with the created Account

## listAccounts

List Accounts
[https://developers.wealthsimple.com/#operation/List%20Accounts][79]

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `params` **[Object][70]?** Optional filter params, See Wealthsimple website for an example of the request parameters

### Examples

```javascript
wealthsimple.listAccounts(token).then(response=>console.log(response));
```

```javascript
wealthsimple.listAccounts(token,params).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with the list of accounts

## getAccount

Get Account
[https://developers.wealthsimple.com/#operation/Get%20Account][80]

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `accountId` **[String][68]** Account ID String

### Examples

```javascript
wealthsimple.listAccounts(token).then(response=>console.log(response));
```

```javascript
wealthsimple.getAccount(token,accountId).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with the account details

## getAccountTypes

Get Account Types
[https://developers.wealthsimple.com/#operation/Get%20Account%20Types][81]
Returns openable account types. If a client_id is provided it will scope the types to the client in question, otherwise it will default to the requestor

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `params` **[Object][70]?** Optional filter params, See Wealthsimple website for an example of the request parameters

### Examples

```javascript
wealthsimple.getAccountTypes(token).then(response=>console.log(response));
```

```javascript
wealthsimple.getAccountTypes(token,params).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with the account details

## getDailyValues

Get Daily Values
[https://developers.wealthsimple.com/#operation/List%20Daily%20Values][82]
Returns historical daily values for a given account. This API will only return a maximum of 365 days worth of daily values from a given start date. By default, it will return historical values for the last 30-days. The start date must occur before the end date if provided. If the difference between the start date and the end date exceeds 365 days, an error will be thrown. The number of Daily Values can be potentially prohibitively large, the results are paginated.

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `params` **[Object][70]?** Optional filter params, See Wealthsimple website for an example of the request parameters
    -   `params.accound_id` **[Object][70]** Required account_id param

### Examples

```javascript
wealthsimple.getDailyValues(token,{ params.accound_id: "rrsp-r3e9c1w" }).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with the account daily values

## listPositions

List Positions
[https://developers.wealthsimple.com/#tag/Positions][83]
Returns positions for a given account. This API will also allow you to retrieve historical Positions held on a given date.

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `params` **[Object][70]?** Optional filter params, See Wealthsimple website for an example of the request parameters
    -   `params.accound_id` **[Object][70]** Required account_id param

### Examples

```javascript
wealthsimple.listPositions(token,{ params.accound_id: "rrsp-r3e9c1w" }).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with the account positions

## listTransactions

List Transactions
[https://developers.wealthsimple.com/#operation/List%20Transactions][84]
Lists all Transactions. The number of Transactions can be potentially prohibitively large, the results are paginated. By default, the API will return the 250 latest transactions in the last 30 days.

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `params` **[Object][70]?** Optional filter params, See Wealthsimple website for an example of the request parameters
    -   `params.accound_id` **[Object][70]** Required account_id param

### Examples

```javascript
wealthsimple.listTransactions(token,{ params.accound_id: "rrsp-r3e9c1w" }).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with the account transactions

## getProjection

Get Projection
[https://developers.wealthsimple.com/#operation/Get%20Projection][85]
Retrieves a projections of returns for an account based on deposits and frequency.

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `params` **[Object][70]** Projection params
    -   `params.accound_id` **[Object][70]** Required account_id param
    -   `params.amount` **[Object][70]** Required deposit amount
    -   `params.frequency` **[Object][70]** Required deposit frequency
    -   `params.start_date` **[Object][70]** Required deposit start date

### Examples

```javascript
wealthsimple.getProjection(token, params).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with the projection

## listBankAccounts

List Bank Accounts
[https://developers.wealthsimple.com/#operation/List%20Bank%20Accounts][86]

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `params` **[Object][70]?** See website for optional query params

### Examples

```javascript
wealthsimple.listBankAccounts(token, params).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with list of bank accounts

## createDeposit

Create Deposit
[https://developers.wealthsimple.com/#operation/Create%20Deposit][87]
Initiates an electronic funds transfer to deposit funds to an Account from a Bank Account

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `body` **[Object][70]** Required deposit details
    -   `body.bank_account_id` **[Object][70]** The unique id of the Bank Account
    -   `body.account_id` **[Object][70]** The unique id of the Account
    -   `body.amount` **[Object][70]** Dollar amount
    -   `body.currency` **[Object][70]** Currency

### Examples

```javascript
wealthsimple.createDeposit(token, body).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with deposit info

## listDeposits

List Deposits
[https://developers.wealthsimple.com/#operation/List%20Deposits][88]

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `params` **[Object][70]?** See website for optional query params

### Examples

```javascript
wealthsimple.listDeposits(token, body).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with deposit list

## getDeposit

Get Deposit
[https://developers.wealthsimple.com/#operation/List%20Deposits][88]

### Parameters

-   `host`  
-   `tokens` **[Object][70]** Tokens object from Wealthsimple
-   `fundsTransferId` **[String][68]** funds_transfer_id

### Examples

```javascript
let fundsTransferId = "funds_transfer_id-r3e9c1w";
wealthsimple.getDeposit(token, fundsTransferId).then(response=>console.log(response));
```

Returns **[Promise][69]** Promise which will resolve with a deposit entity.

[1]: #tokenexchange

[2]: #parameters

[3]: #examples

[4]: #tokenrefresh

[5]: #parameters-1

[6]: #examples-1

[7]: #refreshtokenifexpired

[8]: #parameters-2

[9]: #createuser

[10]: #parameters-3

[11]: #examples-2

[12]: #listusers

[13]: #parameters-4

[14]: #examples-3

[15]: #getuser

[16]: #parameters-5

[17]: #examples-4

[18]: #createperson

[19]: #parameters-6

[20]: #examples-5

[21]: #listpeople

[22]: #parameters-7

[23]: #examples-6

[24]: #getperson

[25]: #parameters-8

[26]: #examples-7

[27]: #updateperson

[28]: #parameters-9

[29]: #examples-8

[30]: #createaccount

[31]: #parameters-10

[32]: #examples-9

[33]: #listaccounts

[34]: #parameters-11

[35]: #examples-10

[36]: #getaccount

[37]: #parameters-12

[38]: #examples-11

[39]: #getaccounttypes

[40]: #parameters-13

[41]: #examples-12

[42]: #getdailyvalues

[43]: #parameters-14

[44]: #examples-13

[45]: #listpositions

[46]: #parameters-15

[47]: #examples-14

[48]: #listtransactions

[49]: #parameters-16

[50]: #examples-15

[51]: #getprojection

[52]: #parameters-17

[53]: #examples-16

[54]: #listbankaccounts

[55]: #parameters-18

[56]: #examples-17

[57]: #createdeposit

[58]: #parameters-19

[59]: #examples-18

[60]: #listdeposits

[61]: #parameters-20

[62]: #examples-19

[63]: #getdeposit

[64]: #parameters-21

[65]: #examples-20

[66]: #_istokenexpired

[67]: #parameters-22

[68]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[69]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise

[70]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[71]: https://developers.wealthsimple.com/#operation/Create%20User

[72]: https://developers.wealthsimple.com/#operation/List%20Users

[73]: https://developers.wealthsimple.com/#operation/Get%20User

[74]: https://developers.wealthsimple.com/#operation/Create%20Person

[75]: https://developers.wealthsimple.com/#operation/List%20People

[76]: https://developers.wealthsimple.com/#operation/Get%20Person

[77]: https://developers.wealthsimple.com/#operation/Update%20Person

[78]: https://developers.wealthsimple.com/#operation/Create%20Account

[79]: https://developers.wealthsimple.com/#operation/List%20Accounts

[80]: https://developers.wealthsimple.com/#operation/Get%20Account

[81]: https://developers.wealthsimple.com/#operation/Get%20Account%20Types

[82]: https://developers.wealthsimple.com/#operation/List%20Daily%20Values

[83]: https://developers.wealthsimple.com/#tag/Positions

[84]: https://developers.wealthsimple.com/#operation/List%20Transactions

[85]: https://developers.wealthsimple.com/#operation/Get%20Projection

[86]: https://developers.wealthsimple.com/#operation/List%20Bank%20Accounts

[87]: https://developers.wealthsimple.com/#operation/Create%20Deposit

[88]: https://developers.wealthsimple.com/#operation/List%20Deposits

[89]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[90]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean
